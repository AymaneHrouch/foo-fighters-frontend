<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/common/css/style.css" />
    <link rel="shortcut icon" type="image/jpg" href="assets/common/img/logo.svg" />
    <style>
      body {
        background-color: #222;
      }
    </style>
    <title>Foo Fighters - Gallery</title>
  </head>
  <body>
    <nav id="main-navbar">
      <a class="logo" href="index.html">
        <img src="assets/common/img/logo.svg" alt="" />
      </a>
      <a href="index.html#members">Members</a>
      <a href="index.html#tour-dates">Tour Dates</a>
      <a href="gallery.html">Gallery</a>
      <a href="albums.html">Albums</a>
      <a href="fans.html">Fans Zone</a>
    </nav>
    <main id="gallery">
      <!-- Slideshow container -->
      <div class="slideshow-container"></div>
      <br />
    </main>

    <script>
      let xhr = new XMLHttpRequest();
      xhr.open("GET", "assets/common/xml/gallery.xml");
      xhr.onreadystatechange = function () {
        let parser = new DOMParser();
        let doc = parser.parseFromString(this.responseText, "text/xml");
        let slideshowContainer = document.querySelector("#gallery div.slideshow-container");
        let images = doc.getElementsByTagName("image");
        for (let i = 0; i < images.length; i++) {
          let src = images[i].querySelector("src").textContent;
          let caption = images[i].querySelector("caption").textContent;
          slideshowContainer.innerHTML += `
                  <div class="mySlides fade">
                        <div class="numbertext">${src.match(/\d*/)[0]} / ${images.length}</div>
                        <img src="assets/common/img/gallery/${src}"/>
                        <div class="caption">${caption}</div>
                        </div>`;
        }

        slideshowContainer.innerHTML += `
                    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                    <a class="next" onclick="plusSlides(1)">&#10095;</a>`;

        // Initialiser la premiere image qui va être affiché
        var slideIndex = 1;
        showSlides(slideIndex);
      };

      xhr.send();

      // Pour sauter les images, on va l'utiliser pour les boutons suivante/précédente
      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      // Pour établir l'image
      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        if (n > slides.length) {
          slideIndex = 1;
        }
        if (n < 1) {
          slideIndex = slides.length;
        }
        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }
        slides[slideIndex - 1].style.display = "block";
      }

      document.addEventListener("keydown", ({ key }) => {
        if (key === "ArrowLeft") plusSlides(-1);
        else if (key === "ArrowRight") plusSlides(1);
      });
    </script>
  </body>
</html>
